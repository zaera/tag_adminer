{% extends 'template.html' %}
{% block body_content %}
    {% load poll_extras %}
    {% load static %}
    <!--     <script src="{% static 'assets/js/bootstrap.min.js' %}"></script>
    <script src="{% static 'assets/js/jquery-3.2.1.min.js' %}"></script>
    <script src="{% static 'js/jquery.bootstrap.modal.forms.js' %}"></script>
    -->
    <!-- You can alternatively load the minified version -->
    <script src="{% static 'js/jquery.bootstrap.modal.forms.min.js' %}"></script>
    <div class="row justify-content-center">
        <div class="col-auto">
            <div id="textSection">
            </div>
        <br>
{{count}}
         <br>
         <br>
{% for item in data %}

    pk: {{ item.0}}
    &nbsp;&nbsp;
    {{ item.1}}
    &nbsp;&nbsp;
    {{ item.2}}
    &nbsp;&nbsp;
    {{ item.3}}
    &nbsp;&nbsp;
    {{ item.4}}
    &nbsp;&nbsp;
    {{ item.5}}
    &nbsp;&nbsp;
    {{ item.6}}
    &nbsp;&nbsp;
    {{ item.7}}
    &nbsp;&nbsp;
    {{ item.8}}

    <br>
            {% endfor %}
        </div>
    </div>
    <div class="modal fade" tabindex="-1" role="dialog" id="modal">
        <div class="modal-dialog" role="document">
            <div class="modal-content"></div>
        </div>
    </div>


    <!-- Return to Top -->
    <a href="javascript:" id="return-to-top"><i class="fa fa-arrow-circle-up fa-4"></i></a>

    <script type="text/javascript">
        $(document).ready(function () {
            $(".update-runner").each(function () {
                $(this).modalForm({formURL: $(this).data("form-url")});
            });
            $(".update-group").each(function () {
                $(this).modalForm({formURL: $(this).data("form-url")});
            });
            $(".read-wrist").each(function () {
                $(this).modalForm({formURL: $(this).data("form-url")});
            });
            $(".update-wrist").each(function () {
                $(this).modalForm({formURL: $(this).data("form-url")});
            });
            $(".delete-wrist").each(function () {
                $(this).modalForm({formURL: $(this).data("form-url"), isDeleteForm: true});
            });
            $(".modal").on('shown.bs.modal', function () {
                try {
                    document.getElementById("id_wrist_passed").classList.remove("form-control");
                } catch (error) {
                }
                try {
                    $('label[for=id_wrist_competition_id], input#id_wrist_competition_id').hide();
                    $('label[for=id_wrist_firmware], input#id_wrist_firmware').hide();
                    $('label[for=id_wrist_voltage], input#id_wrist_voltage').hide();
                    $('label[for=id_wrist_sn], input#id_wrist_sn').hide();
                } catch (error) {
                }
                try {
                    $('label[for=id_runner_competition_id], input#id_runner_competition_id').hide();
                } catch (error) {
                }
                try {
                    $('label[for=id_group_competition_id], input#id_group_competition_id').hide();
                } catch (error) {
                }
            });
        });

        function scroll() {
            window.scrollBy(0, 3);
            scrolldelay = setTimeout(scroll, 50);
        }

        // ===== Scroll to Top ====
        $(window).scroll(function () {
            if ($(this).scrollTop() >= 50) {        // If page is scrolled more than 50px
                $('#return-to-top').fadeIn(200);    // Fade in the arrow
            } else {
                $('#return-to-top').fadeOut(200);   // Else fade out the arrow
            }
        });
        $('#return-to-top').click(function () {      // When arrow is clicked
            $('body,html').animate({
                scrollTop: 0                       // Scroll to top of body
            }, 500);
        });

        let upd = 0;

        function readTextFile() {
            let rawFile = new XMLHttpRequest();
            rawFile.open("GET", "{% static 'upd.txt' %}", true);
            rawFile.onreadystatechange = function () {
                if (rawFile.readyState === 4) {
                    let allText = rawFile.responseText;
                    if (upd != allText) {
                        upd = allText;
                        document.getElementById("textSection").innerHTML = allText;
                        console.log(allText)
                        console.log('updated')
                    } else {
                        console.log('all is ok')
                    }
                }
            }
            rawFile.send();
        }
        {#window.setInterval(function () {#}
        {#    readTextFile();#}
        {#}, 5000);#}
    </script>
{% endblock body_content %}